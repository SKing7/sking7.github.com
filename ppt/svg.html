<!DOCTYPE HTML>
<html>
<head>
    <title>html5 canvas Arc</title>
    <style>
        body {margin: 0px;padding: 0px;}
        .content { position:relative; }
    </style>
</head>
<body>
    <div class="content">
        <svg style="" id="svg" xmlns="http://www.w3.org/2000/svg" version="1.1">
            <line id="l" x1="100" y1="200" x2="100" y2="200" style="stroke:rgb(0,0,0);stroke-width:2"/>
            <circle style="display:none" cy="50" r="3" stroke="black" stroke-width="1" fill="black"/>
            <circle style="display:none" cy="50" r="3" stroke="black" stroke-width="1" fill="black"/>
            <circle style="display:none" cy="50" r="3" stroke="black" stroke-width="1" fill="black"/>
            <circle style="display:none" cy="50" r="3" stroke="black" stroke-width="1" fill="black"/>
            <circle style="display:none" cy="50" r="3" stroke="black" stroke-width="1" fill="black"/>
            <circle style="display:none" cy="50" r="3" stroke="black" stroke-width="1" fill="black"/>
            <circle style="display:none" cy="50" r="3" stroke="black" stroke-width="1" fill="black"/>
        </svg>
    </div>
    <script>
        +function() {
        var svg = $("svg"),
            line = $('l', svg),
            interval,
            speed_x = 3,
            speed_y = 0,
            start_x = 100,
            start_y = 200,
            pre_x = start_x,
            pre_y = start_y,
            pre_x,
            pre_y,
            count = 0,
            ccs = getByTag('circle'),
            time
            ;
        document.onclick = function() {
            if (!svg || !line) return;
            doSteps();
        };
        function $(id, t) {
            return (t && t.getElementById(id)) || document.getElementById(id);
        }
        function getByTag(tag) {
            return document.getElementsByTagName(tag);
        }
        function doSteps() {
            if (count >= ccs.length) {return;}
            if (interval) {
               speed_x += (speed_x ==0 ? 0 : 1) ;
               speed_y += (speed_y ==0 ? 0 : 1) ;
               window.clearInterval(interval);
            } else {
                time = new Date().getTime();
            }
            interval = window.setInterval(fun, 50);
            function fun() {
                console.log(count);
                if (new Date().getTime() - time < 2000 ) {
                    line.setAttribute('x2', (start_x = start_x + speed_x)); 
                    line.setAttribute('y2', (start_y = start_y + speed_y));
                    return;
                }
                ccs[count].style.display = 'block';
                ccs[count].setAttribute('cx', start_x);
                ccs[count].setAttribute('cy', start_y);
                count++;
                window.clearInterval(interval);
                interval = undefined;
            }
        }
        }();
    </script>
</body>
</html>

