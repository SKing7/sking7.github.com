
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head profile="http://gmpg.org/xfn/11">
	<title>How HTTPS Secures Connections: What Every Web Dev Should Know</title>
	<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
	
	<link rel="stylesheet" type="text/css" href="http://blog.hartleybrody.com/wp-content/themes/wp-hartley-brody/reset.css" />
	<link rel="stylesheet" type="text/css" href="http://blog.hartleybrody.com/wp-content/themes/wp-hartley-brody/font/font.css" />
	<link rel="stylesheet" type="text/css" href="http://blog.hartleybrody.com/wp-content/themes/wp-hartley-brody/style.css" />
	
	<link rel="alternate" type="application/rss+xml" title="Hartley Brody &raquo; How HTTPS Secures Connections: What Every Web Dev Should Know Comments Feed" href="http://blog.hartleybrody.com/https-certificates/feed/" />
<script type='text/javascript' src='http://blog.hartleybrody.com/wp-includes/js/jquery/jquery.js?ver=1.10.2'></script>
<script type='text/javascript' src='http://blog.hartleybrody.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.2.1'></script>
<script type='text/javascript' src='http://blog.hartleybrody.com/wp-content/plugins/timeago/jquery.timeago.js?ver=3.6.1'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://blog.hartleybrody.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://blog.hartleybrody.com/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Are You A Hacker, Developer or Engineer? (And Why it Matters)' href='http://blog.hartleybrody.com/hacker-developer-engineer/' />
<link rel='next' title='The &#8220;Ultimate Guide to Web Scraping&#8221; is Now Available' href='http://blog.hartleybrody.com/web-scraping-guide/' />
<link rel='shortlink' href='http://wp.me/p1sUz8-B5' />

<!-- All in One SEO Pack 2.0 by Michael Torbert of Semper Fi Web Design[225,315] -->
<link rel="author" href="hartleybrody" />
<meta name="description" content="How does HTTPS actually work? That was the question I set out to solve a few days ago for a project at work. As a web developer, I knew that using HTTPS to" />

<meta name="keywords" content="uncategorized" />

<link rel="canonical" href="http://blog.hartleybrody.com/https-certificates/" />
<!-- /all in one seo pack -->
<meta id="syntaxhighlighteranchor" name="syntaxhighlighter-version" content="3.1.5" />
<link rel="stylesheet" href="http://blog.hartleybrody.com/wp-content/plugins/timeago/timeago.css" type="text/css" />
	<link rel="alternate" type="application/rss+xml" href="http://blog.hartleybrody.com/feed/" title="Hartley Brody latest posts" />
	<link rel="alternate" type="application/rss+xml" href="http://blog.hartleybrody.com/comments/feed/" title="Hartley Brody latest comments" />
	<link rel="pingback" href="http://blog.hartleybrody.com/xmlrpc.php" />
	
	<link rel="icon" type="image/bmp" href="http://hart.ly/wp-content/themes/wp-hartley-brody/favicon.bmp" /> 
	
	<!--facebook meta info-->
	<meta property="fb:admins" content="1428990153" />

	<!--google share +1 button-->
	<script type="text/javascript" src="http://apis.google.com/js/plusone.js"></script>
		
		<script type="text/javascript">

		  var _gaq = _gaq || [];
		  _gaq.push(['_setAccount', 'UA-9472773-3']);
		  _gaq.push(['_trackPageview']);
		  _gaq.push(['_trackPageLoadTime']);

		  (function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		  })();

		</script>


</head>

<body>


<div id="container">

	<div id="header">
		<a href="http://blog.hartleybrody.com/" rel="home"><h1>Hartley Brody</h1></a>
	</div>

	
<div id="content">

 <!--BEGIN:LOOP-->


	<div class="post-2299 post type-post status-publish format-standard hentry category-uncategorized" >

		<!-- BEGIN: DIFFERENT CONTENT FOR DIFFERENT TEMPLATES-->

		<h2>How HTTPS Secures Connections: What Every Web Dev Should Know</h2>
		
		<ul class="meta">
			<li class="inline"><abbr class='timeago' title='2013-07-25 02:40:22Z'>Wednesday, July 24th, 2013 09:40 pm GMT -5</abbr></li>
			<li class="inline"></li>
		</ul> 
        
		<div class="post-content">
			<p><img src="http://blog.hartleybrody.com/wp-content/uploads/2013/07/https-certificate.png" alt="https certificate icon" width="120" class="alignright size-full wp-image-2301" />How does HTTPS <em>actually</em> work? That was the question I set out to solve a few days ago for a project at work. </p>
<p>As a web developer, I knew that using HTTPS to protect users&#8217; sensitive data was A Very Good Idea, but I didn&#8217;t have much understanding about how it actually worked.</p>
<p>How was data protected? How can a client and server create a secure connection if someone was already listening in on the wire? What is a security certificate and why do I need to pay someone to get one?</p>
<h3>A Series of Tubes</h3>
<p>Before we dive into how it all works, let&#8217;s talk briefly about why it&#8217;s important to secure connections in the first place, and what sorts of things HTTPS guards against.</p>
<p>When you make a request to visit your favorite website, that request must pass through many different networks &#8212; any of which could be used to potentially eavesdrop or tamper with your connection. </p>
<p><img src="http://blog.hartleybrody.com/wp-content/uploads/2013/07/series-of-tubes.png" alt="series of tubes" width="500" class="aligncenter size-medium wp-image-2303" /></p>
<p>From your own computer to other machines on your local network, to the access point itself, through routers and switches all the way to the ISP and through the backbone providers, there are a lot of different organizations who ferry a request along. If a malicious user got into any one of those systems, then they have the potential to see what&#8217;s traveling through the wire.</p>
<p>Normally, web requests are sent over regular ol&#8217; HTTP, where a client&#8217;s request and the server&#8217;s response are both sent as plain text. There are <a href="http://security.stackexchange.com/a/18861/4327" target="_blank">lots of good reasons why HTTP doesn&#8217;t use secure encryption by default</a>:</p>
<ul>
<li>Security requires more computation power</li>
<li>Security requires more bandwidth</li>
<li>Security breaks caching</li>
</ul>
<p>But sometimes, as the developer of a web application, you know that sensitive information like passwords or credit card data will be going over the connection, so it&#8217;s necessary to take extra precautions against snooping on those pages.</p>
<p><span id="more-2299"></span><br />
<h3>Transport Layer Security (TLS)</h3>
<p>We&#8217;re about to dive into the world of cryptography, but you shouldn&#8217;t need much experience to keep up. We&#8217;ll really only be scratching the surface. Cryptography is the practice of securing communications against potential adversaries &#8212; people who might want to interfere with the communication, or just listen in. </p>
<p>TLS &#8212; the successor to SSL &#8212; is a protocol that&#8217;s most often used to implement secure HTTP connections (ie HTTPS). TLS sits at a lower level in the <a href="http://en.wikipedia.org/wiki/OSI_model#Examples" target="_blank">OSI model</a> than HTTP, which is basically a fancy way of saying that, during a web request the TLS connection stuff happens before the HTTP connection stuff.</p>
<p>TLS is a hybrid cryptographic system, meaning it makes use of multiple crypto paradigms, both of which we&#8217;ll look at next:</p>
<blockquote><p>
<strong>Public Key Cryptography</strong> for shared secret generation and authentication (making sure you are who you say you are).</p>
<p><strong>Symmetric Key Cryptography</strong> using shared secrets for encrypting requests and responses.
</p></blockquote>
<h3>Public Key Encryption</h3>
<p>Public key encryption is a type of cryptographic system where each party has both a private and a public key, which are mathematically linked to each other. The public key is used for encrypting plaintext to &#8220;ciphertext&#8221; (essentially, gibberish), while the private key is used for decrypting that gibberish back into plaintext. </p>
<p>Once a message has been encrypted by a public key, it can <strong>only</strong> be decrypted with the corresponding private key. Neither key can perform both functions by itself. The public key can be published freely without compromising the security of the system, but the private key must not be revealed to anyone who isn&#8217;t authorized to decrypt messages. Hence the names, public and private.</p>
<p>One of the cool benefits of public key cryptography is that two parties with no prior knowledge of each other can create a secure connection <strong>while initially communicating over an open, insecure connection.</strong></p>
<p>The client and the server can both use their own private keys &#8212; along with some shared, public information &#8212; to agree upon a <strong>shared secret key</strong> for the session. </p>
<p>That means that even if someone is sitting in between the client and server and watches the connection happen, they still can&#8217;t determine the private keys of either the client or the server, or the secret key for the session.</p>
<p>How is this possible? Math!</p>
<p><strong>Diffie-Hellman</strong><br />
One of the most common way this exchange is performed is by using a <a href="http://en.wikipedia.org/wiki/Diffie%E2%80%93Hellman_key_exchange" target="_blank">Diffie-Hellman key exchange</a>. This process allows the client and sever to agree upon a shared secret, without having to transmit that secret over the connection. Again, snoopers can&#8217;t determine the shared secret even if they&#8217;re watching every packet on the connection. </p>
<p>Once the initial DH exchange takes place, the resulting shared secret can be used to encrypt further communications in that session using a much simpler symmetric key encryption, which we&#8217;ll look at in a bit.</p>
<p><strong>A Bit of Math&#8230;</strong><br />
The math behind it is actually fairly simple to calculate one way, but essentially impossible to reverse. This is where the importance of having really large prime numbers comes into play.</p>
<p>If Alice and Bob are two parties performing a DH key exchange, they start by agreeing on a <em>root</em> (generally a small number, like 2, 3 or 5) and a large <em>prime</em> (300+ digits), both of which can be sent in the clear without compromising the security of the exchange.</p>
<p>Remember, Alice and Bob each have their own private key (100+ digits) that should never be shared, either between them or with anyone else. What they exchange publicly over the network is a <em>mixture</em> of their private keys, plus the root and the prime. Specifically: </p>
<blockquote><p>
Alice&#8217;s mixture = (root <sup>Alice&#8217;s Secret</sup>) % prime<br />
Bob&#8217;s mixture = (root <sup>Bob&#8217;s Secret</sup>) % prime<br />
<small>% here means modulo, taking the remainder after division</small>
</p></blockquote>
<p>So Alice creates her mixture using the agreed upon constants (<em>root</em> and <em>prime</em>) plus her private key, and Bob does the same. Once they&#8217;ve received each other&#8217;s mixture, they then perform some more math to derive the shared secret for the session. Specifically:</p>
<blockquote><p>
<em>Alice Calculates</em><br />
(Bob&#8217;s mixture <sup>Alice&#8217;s Secret</sup>) % prime</p>
<p><em>Bob Calculates</em><br />
(Alice&#8217;s mixture <sup>Bob&#8217;s Secret</sup>) % prime
</p></blockquote>
<p>This calculation generates the same number for both Alice and Bob, and that number becomes the shared secret for this session. Note that neither party had to send their private key to the other one, and the resulting shared secret was