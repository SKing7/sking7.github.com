<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="keywords" content="web performance faster web sites high performance web sites website optimization best practices javascript css web development mobile">
<title>Domain Sharding revisited | High Performance Web Sites</title>
<link rel="stylesheet" type="text/css" media="all" href="http://www.stevesouders.com/blog/wp-content/themes/SteveSouders/style.css" />
<link rel="alternate" type="application/rss+xml" title="High Performance Web Sites &raquo; Domain Sharding revisited Comments Feed" href="http://www.stevesouders.com/blog/2013/09/05/domain-sharding-revisited/feed/" />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://www.stevesouders.com/blog/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://www.stevesouders.com/blog/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Web performance for the future' href='http://www.stevesouders.com/blog/2013/08/27/web-performance-for-the-future/' />
<meta name="generator" content="WordPress 3.6.1" />
<link rel='canonical' href='http://www.stevesouders.com/blog/2013/09/05/domain-sharding-revisited/' />
<link rel='shortlink' href='http://www.stevesouders.com/blog/?p=3720' />
<script type="text/javascript">
	window._wp_rp_static_base_url = 'http://dtmvdvtzf8rz0.cloudfront.net/static/';
	window._wp_rp_wp_ajax_url = "http://www.stevesouders.com/blog/wp-admin/admin-ajax.php";
	window._wp_rp_plugin_version = '2.6';
	window._wp_rp_post_id = '3720';
	window._wp_rp_num_rel_posts = '5';
</script>

<script>
(function(d, s) {
	var js = d.getElementsByTagName(s)[0],
		ln = d.createElement(s);
	ln.src = '//lognormal.net/boomerang/8fa4fc2785a82fae20c596ca4f45d1b218a9ab12ffef741d09b29532';
	js.parentNode.insertBefore(ln, js);
})(document, 'script');
</script>

<script type="text/javascript">
// GOOGLE ANALYTICS
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-15026169-1']);
_gaq.push(['_setSiteSpeedSampleRate', 100]);
_gaq.push(['_trackPageview']);

(function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();
</script>
</head>

<body>
<div id="header">
	<div class="containerwrapper">
  		<h1 id="logo"><a href="http://stevesouders.com/"><span>SteveSouders.com</span></a></h1>
        <ul id="topnav">
        <li><a href="http://stevesouders.com/about.php">about</a></li>
        <li><a href="http://stevesouders.com/contact.php">contact</a></li>
        <li class="last"> <a href="http://twitter.com/#!/souders/"><img src="/images/twitter-icon.png" width=16 height=16 border=0 style="vertical-align: bottom;"></a>
        </ul>
	</div>    
</div>
<div id="contentWrapper" class="containerwrapper">
<div id="sidebar">
<div id="search-3" class="widget widget_search"><form role="search" method="get" id="searchform" class="searchform" action="http://www.stevesouders.com/blog/">
				<div>
					<label class="screen-reader-text" for="s">Search for:</label>
					<input type="text" value="" name="s" id="s" />
					<input type="submit" id="searchsubmit" value="Search" />
				</div>
			</form></div><div id="custom-recent-posts-3" class="widget custom-recent-posts"><h3 class="blockheader">Most Recent Posts</h3>		<ul style="list-style-type: none; margin-left: 20px; text-indent: -20px;">
        		<li><a href="http://www.stevesouders.com/blog/2013/09/05/domain-sharding-revisited/" rel="bookmark">Domain Sharding revisited</a></li>
				<li><a href="http://www.stevesouders.com/blog/2013/08/27/web-performance-for-the-future/" rel="bookmark">Web performance for the future</a></li>
				<li><a href="http://www.stevesouders.com/blog/2013/07/16/activetable-bookmarklet/" rel="bookmark">ActiveTable bookmarklet</a></li>
				<li><a href="http://www.stevesouders.com/blog/2013/07/15/twitter-widget-update/" rel="bookmark">Twitter widget update</a></li>
				<li><a href="http://www.stevesouders.com/blog/2013/06/16/browser-busy-indicators/" rel="bookmark">Browser Busy Indicators</a></li>
				</ul>
		<a href="http://www.stevesouders.com/blog/archives/">View Archive</a></div><div id="text-3" class="widget widget_text"><h3 class="blockheader">Feeds</h3>			<div class="textwidget"><a href="http://www.stevesouders.com/blog/feed/"><img src="/blog/wp-content/uploads/2011/02/feed.png" width="10" height="10" /> </a><a href="http://www.stevesouders.com/blog/feed/">Posts</a><br />
<a href="http://www.stevesouders.com/blog/comments/feed/"><img src="/blog/wp-content/uploads/2011/02/feed.png" width="10" height="10" /> </a><a href="http://www.stevesouders.com/blog/comments/feed/">Comments</a></li></div>
		</div>        
</div><div id="content">



		<div id="post-3720" class="post-3720 post type-post status-publish format-standard hentry category-evangelism category-http category-http-archive category-performance category-web-development tag-domain-sharding tag-spdy">
        	            	<h1>Domain Sharding revisited</h1>
            
			<p class="meta">September 5, 2013 10:41 am | <a href="http://www.stevesouders.com/blog/2013/09/05/domain-sharding-revisited/#comments" title="Comment on Domain Sharding revisited">12 Comments</a></p><!-- .entry-meta -->

			<p>With the adoption of SPDY and progress on HTTP 2.0, I hear some people referring to <a href="http://www.stevesouders.com/blog/2009/05/12/sharding-dominant-domains/">domain sharding</a> as a performance anti-pattern. I disagree. Sharding resources across multiple domains is a major performance win for many websites. However, there is room for debate. Domain sharding isn&#8217;t appropriate for everyone. It may hurt performance if done incorrectly. And it&#8217;s utility might be short-lived. Is it worth sharding domains? Let&#8217;s take a look.</p>
<h3>Compelling Data</h3>
<p>The <a href="http://httparchive.org/">HTTP Archive</a> has a field call &#8220;maxDomainReqs&#8221;. The explanation requires a few sentences: Websites request resources from various domains. The average website today accesses 16 different domains as shown in the chart below. That number has risen from 12.5 a year ago. That&#8217;s not surprising given the rise in third party content (ads, widgets, analytics).</p>
<p><a href="http://httparchive.org/trends.php#numDomains&amp;maxDomainReqs"><img class="aligncenter" alt="" src="http://stevesouders.com/images/ha-domains.png" width="490" /></a></p>
<p>The HTTP Archive counts the number of requests made on each domain. The domain with the most requests is the &#8220;max domain&#8221; and the number of requests on that domain is the &#8220;maxDomainReqs&#8221;. The average maxDomainReqs value has risen from 47 to 50 over the past year. That&#8217;s not a huge increase, but the fact that the average number of requests on one domain is so high is startling.</p>
<p>50 is the <em>average</em> maxDomainReqs across the world&#8217;s top 300K URLs. But averages don&#8217;t tell the whole story. Using the <a href="http://www.igvita.com/2013/06/20/http-archive-bigquery-web-performance-answers/">HTTP Archive data in BigQuery</a> and <a href="http://bigqueri.es/">bigqueri.es</a>, both created by Ilya Grigorik, it&#8217;s easy to find <a href="http://bigqueri.es/t/max-requests-to-one-hostname/67">percentile values for maxDomainReqs</a>: the 50th percentile is 39, the 90th percentile is 97, and the 95th percentile is 127 requests on a single domain.</p>
<p>This data shows that a majority of websites have 39 or more resources being downloaded from a single domain. Most browsers do <a href="http://www.browserscope.org/?category=network&amp;v=1">six requests per hostname</a>. If we evenly distribute these 39 requests across the connections, each connection must do 6+ sequential requests. Response times per request vary widely, but I use 5