<!doctype html>
<html>
<head>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>The protocol-relative URL - Paul Irish</title>
<link rel="stylesheet" href="../css/article.css" />
</head>
<body>
<div><p>There’s this little trick you can get away with that’ll save you some headaches:</p><figure><figcaption><span></span></figcaption><div><table><tr><td><pre><span>1</span>
</pre></td><td><pre><code><span><span>&lt;img</span> <span>src=</span><span>"//domain.com/img/logo.png"</span><span>&gt;</span>
</span></code></pre></td></tr></table></div></figure><p><img src="http://paulirish.com/wp-content/uploads/2010/10/this-page-contains-both-secure-and-nonsecure-items.gif" align="right" />If the browser is viewing that current page in through HTTPS, then it’ll request that asset with the HTTPS protocol, otherwise it’ll typically* request it with HTTP. This prevents that awful “This Page Contains Both Secure and Non-Secure Items” error message in IE, keeping all your asset requests within the same protocol.</p><p>*Of course, if you’re viewing the file locally, it’ll try to request the file with the <code>file://</code> protocol.</p><p>We use this trick in the <a href="http://html5boilerplate.com">HTML5 Boilerplate</a> for a clever request of jQuery off the Google CDN:</p><figure><figcaption><span></span></figcaption><div><table><tr><td><pre><span>1</span>
<span>2</span>
</pre></td><td><pre><code><span><span>&lt;script </span><span>src=</span><span>"//ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.js"</span><span>&gt;&lt;/script&gt;</span>
</span><span><span>&lt;script&gt;</span><span>!</span><span>window</span><span>.</span><span>jQuery</span> <span>&amp;&amp;</span> <span>document</span><span>.</span><span>write</span><span>(</span><span>unescape</span><span>(</span><span>'%3Cscript src="js/libs/jquery-1.4.2.js"%3E%3C/script%3E'</span><span>))</span><span>&lt;/script&gt;</span>
</span></code></pre></td></tr></table></div></figure><p>Technically, this is called a “network-path reference” according to <a href="http://tools.ietf.org/html/rfc3986#section-4.2">RFC 3986</a>. Oh and if you want to be <a href="http://url.spec.whatwg.org/#concept-scheme-relative-url">truly correct</a>, you’ll use the term “scheme” instead of “protocol” when talking about URLs.</p><p>This trick also works fine in CSS:</p><figure><figcaption><span></span></figcaption><div><table><tr><td><pre><span>1</span>
</pre></td><td><pre><code><span><span>.omgomg</span> <span>{</span> <span>background</span><span>:</span> <span>url(//websbestgifs.net/kittyonadolphin.gif)</span><span>;</span> <span>}</span>
</span></code></pre></td></tr></table></div></figure><p>… assuming the site you’re pointing to has this asset available on both HTTP and HTTPS.</p><p>Caveat: When used on a &lt;link&gt; or @import for a stylesheet, IE7 and IE8 <a href="http://www.stevesouders.com/blog/2010/02/10/5a-missing-schema-double-download/">download the file twice</a>. All other uses, however, are just fine.</p><p><small>Thx to miketaylr, ralphholzmann, annevk for smarts on this, and ajaxian, where I think I learned it like 4 years ago? maybe?</small></p><p>Yes of course, wouldn’t that be nice… So I worked with the Google Analytics javascript lead developer (God, I love working at google) to see if we could do this… turns out we can’t. There is an edgecase bug in IE6 that causes a dialog to blow up… under some security settings (unsure if they are default) when requesting from the non-‘ssl’ subdomain. <a href="http://paulirish.com/i/7b01.png">screenshot here</a>. So feel free to take 40 bytes off your GA snippet if you don’t care about IE6.. otherwise you’re gonna need that ternary operator. :)</p><p>2011.12.24. Eric Law (from the IE team) chimes on why IE6 doesnt play well GA…</p><blockquote>The reason this doesn’t work in IE6 is that the server is using SNI to deduce what certificate to return. XP (and thus IE6) doesn’t support SNI in the HTTPS stack. <a href="http://blogs.msdn.com/b/ieinternals/archive/2009/12/07/certificate-name-mismatch-warnings-and-server-name-indication.aspx">See for details.</a></blockquote></div></body>
</html>