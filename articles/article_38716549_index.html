<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">
    <title></title>
  </head>
  <body>
        <!-- MAIN CONTENT -->
        <div id="main_content_wrap" class="outer">
        <textarea style="visibility:none" id="html-area">
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt;
<html xmlns="http://www.w3.org/1999/xhtml"&gt;
<head&gt;
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;
<meta name="keywords" content="web performance faster web sites high performance web sites website optimization best practices javascript css web development mobile"&gt;
<title&gt;Frontend SPOF | High Performance Web Sites</title&gt;
<link rel="stylesheet" type="text/css" media="all" href="http://www.stevesouders.com/blog/wp-content/themes/SteveSouders/style.css" /&gt;
<link rel="alternate" type="application/rss+xml" title="High Performance Web Sites &raquo; Frontend SPOF Comments Feed" href="http://www.stevesouders.com/blog/2010/06/01/frontend-spof/feed/" /&gt;
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://www.stevesouders.com/blog/xmlrpc.php?rsd" /&gt;
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://www.stevesouders.com/blog/wp-includes/wlwmanifest.xml" /&gt; 
<link rel='prev' title='cross-browser Greasemonkey scripts' href='http://www.stevesouders.com/blog/2010/05/18/cross-browser-greasemonkey-scripts/' /&gt;
<link rel='next' title='Velocity is coming fast June 22-24' href='http://www.stevesouders.com/blog/2010/06/04/velocity-is-coming-fast-june-22-24/' /&gt;
<meta name="generator" content="WordPress 3.6.1" /&gt;
<link rel='canonical' href='http://www.stevesouders.com/blog/2010/06/01/frontend-spof/' /&gt;
<link rel='shortlink' href='http://www.stevesouders.com/blog/?p=1300' /&gt;
<script type="text/javascript"&gt;
	window._wp_rp_static_base_url = 'http://dtmvdvtzf8rz0.cloudfront.net/static/';
	window._wp_rp_wp_ajax_url = "http://www.stevesouders.com/blog/wp-admin/admin-ajax.php";
	window._wp_rp_plugin_version = '2.6';
	window._wp_rp_post_id = '1300';
	window._wp_rp_num_rel_posts = '5';
</script&gt;

<script&gt;
(function(d, s) {
	var js = d.getElementsByTagName(s)[0],
		ln = d.createElement(s);
	ln.src = '//lognormal.net/boomerang/8fa4fc2785a82fae20c596ca4f45d1b218a9ab12ffef741d09b29532';
	js.parentNode.insertBefore(ln, js);
})(document, 'script');
</script&gt;

<script type="text/javascript"&gt;
// GOOGLE ANALYTICS
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-15026169-1']);
_gaq.push(['_setSiteSpeedSampleRate', 100]);
_gaq.push(['_trackPageview']);

(function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();
</script&gt;
</head&gt;

<body&gt;
<div id="header"&gt;
	<div class="containerwrapper"&gt;
  		<h1 id="logo"&gt;<a href="http://stevesouders.com/"&gt;<span&gt;SteveSouders.com</span&gt;</a&gt;</h1&gt;
        <ul id="topnav"&gt;
        <li&gt;<a href="http://stevesouders.com/about.php"&gt;about</a&gt;</li&gt;
        <li&gt;<a href="http://stevesouders.com/contact.php"&gt;contact</a&gt;</li&gt;
        <li class="last"&gt; <a href="http://twitter.com/#!/souders/"&gt;<img src="/images/twitter-icon.png" width=16 height=16 border=0 style="vertical-align: bottom;"&gt;</a&gt;
        </ul&gt;
	</div&gt;    
</div&gt;
<div id="contentWrapper" class="containerwrapper"&gt;
<div id="sidebar"&gt;
<div id="search-3" class="widget widget_search"&gt;<form role="search" method="get" id="searchform" class="searchform" action="http://www.stevesouders.com/blog/"&gt;
				<div&gt;
					<label class="screen-reader-text" for="s"&gt;Search for:</label&gt;
					<input type="text" value="" name="s" id="s" /&gt;
					<input type="submit" id="searchsubmit" value="Search" /&gt;
				</div&gt;
			</form&gt;</div&gt;<div id="custom-recent-posts-3" class="widget custom-recent-posts"&gt;<h3 class="blockheader"&gt;Most Recent Posts</h3&gt;		<ul style="list-style-type: none; margin-left: 20px; text-indent: -20px;"&gt;
        		<li&gt;<a href="http://www.stevesouders.com/blog/2013/09/05/domain-sharding-revisited/" rel="bookmark"&gt;Domain Sharding revisited</a&gt;</li&gt;
				<li&gt;<a href="http://www.stevesouders.com/blog/2013/08/27/web-performance-for-the-future/" rel="bookmark"&gt;Web performance for the future</a&gt;</li&gt;
				<li&gt;<a href="http://www.stevesouders.com/blog/2013/07/16/activetable-bookmarklet/" rel="bookmark"&gt;ActiveTable bookmarklet</a&gt;</li&gt;
				<li&gt;<a href="http://www.stevesouders.com/blog/2013/07/15/twitter-widget-update/" rel="bookmark"&gt;Twitter widget update</a&gt;</li&gt;
				<li&gt;<a href="http://www.stevesouders.com/blog/2013/06/16/browser-busy-indicators/" rel="bookmark"&gt;Browser Busy Indicators</a&gt;</li&gt;
				</ul&gt;
		<a href="http://www.stevesouders.com/blog/archives/"&gt;View Archive</a&gt;</div&gt;<div id="text-3" class="widget widget_text"&gt;<h3 class="blockheader"&gt;Feeds</h3&gt;			<div class="textwidget"&gt;<a href="http://www.stevesouders.com/blog/feed/"&gt;<img src="/blog/wp-content/uploads/2011/02/feed.png" width="10" height="10" /&gt; </a&gt;<a href="http://www.stevesouders.com/blog/feed/"&gt;Posts</a&gt;<br /&gt;
<a href="http://www.stevesouders.com/blog/comments/feed/"&gt;<img src="/blog/wp-content/uploads/2011/02/feed.png" width="10" height="10" /&gt; </a&gt;<a href="http://www.stevesouders.com/blog/comments/feed/"&gt;Comments</a&gt;</li&gt;</div&gt;
		</div&gt;        
</div&gt;<div id="content"&gt;



		<div id="post-1300" class="post-1300 post type-post status-publish format-standard hentry category-browsers category-firefox category-ie8 category-internet-explorer category-performance category-web-development tag-custom-fonts tag-font-face tag-spof"&gt;
        	            	<h1&gt;Frontend SPOF</h1&gt;
            
			<p class="meta"&gt;June 1, 2010 7:49 pm | <a href="http://www.stevesouders.com/blog/2010/06/01/frontend-spof/#comments" title="Comment on Frontend SPOF"&gt;9 Comments</a&gt;</p&gt;<!-- .entry-meta --&gt;

			<p&gt;My evangelism of high performance web sites started off in the context of quality code and development best practices. It&#8217;s easy for a style of coding to permeate throughout a company. Developers switch teams. Code is copied and pasted (especially in the world of web development). If everyone is developing in a high performance way, that&#8217;s the style that will characterize how the company codes.</p&gt;
<p&gt;This argument of promoting development best practices gained traction in the engineering quarters of the companies I talked to, but performance improvements continued to get backburnered in favor of new features and content that appealed to the business side of the organization. Improving performance wasn&#8217;t considered as important as other changes. Everyone assumed users wanted new features and that&#8217;s what got the most attention.</p&gt;
<p&gt;It became clear to me that we needed to show a business case for web performance. That&#8217;s why the theme for <a href="http://en.oreilly.com/velocity2009"&gt;Velocity 2009</a&gt; was &#8220;the impact of performance on the bottom line&#8221;. Since then there have been <a href="http://blog.mozilla.com/metrics/category/website-optimization/"&gt;numerous</a&gt; <a href="http://radar.oreilly.com/2009/07/velocity-making-your-site-fast.html"&gt;studies</a&gt; <a href="http://www.stevesouders.com/blog/2009/07/27/wikia-fast-pages-retain-users/"&gt;released</a&gt; <a href="http://carsonified.com/blog/business/fred-wilsons-10-golden-principles-of-successful-web-apps/"&gt;that</a&gt; <a href="http://www.watchingwebsites.com/archives/proof-that-speeding-up-websites-improves-online-business"&gt;have</a&gt; <a href="http://googlewebmastercentral.blogspot.com/2010/04/using-site-speed-in-web-search-ranking.html"&gt;shown</a&gt; that improving performance <em&gt;does</em&gt; improve the bottom line. As a result, I&#8217;m seeing the business side of many web companies becoming strong advocates for <a href="http://www.stevesouders.com/blog/2010/05/07/wpo-web-performance-optimization/"&gt;Web Performance Optimization</a&gt;.</p&gt;
<p&gt;But there are still occasions when I have a hard time convincing a team that focusing on web performance, specifically frontend performance, is important. Shaving off hundreds (or even thousands) of milliseconds just doesn&#8217;t seem worthwhile to them. That&#8217;s when I pull out the big guns and explain that <em&gt;loading scripts and stylesheets in the typical way creates a frontend single point of failure that can bring down the entire site</em&gt;.</p&gt;
<h2&gt;Examples of Frontend SPOF</h2&gt;
<p&gt;The thought that simply adding a script or stylesheet to your web page could make the entire site unavailable surprises many people. Rather than focusing on CSS mistakes and JavaScript errors, the key is to think about what happens when a resource request times out. With this clue, it&#8217;s easy to create a test case:</p&gt;
<pre style="margin-left: 20px; margin-right: 20px; background: #F0F0F0; padding: 8px; margin-bottom: 0;"&gt;&lt;html&gt;
&lt;head&gt;
&lt;script src="http://www.snippet.com/main.js" type="text/javascript"&gt;
  &lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
Here's my page!
&lt;/body&gt;
&lt;/html&gt;</pre&gt;
<p&gt;This HTML page looks pretty normal, but if snippet.com is overloaded the entire page is blank waiting for main.js to return. This is true in all browsers.</p&gt;
<p&gt;Here are some examples of frontend single points of failure and the browsers they impact. You can click on the Frontend SPOF test links to see the actual test page.</p&gt;
<table style="border: 2px solid #777;" border="0" cellspacing="0" cellpadding="0"&gt;
<tbody&gt;
<tr&gt;
<th style="background: #333; color: #fff; padding: 4px;"&gt;Frontend SPOF test</th&gt;
<th style="background: #333; color: #fff; padding: 4px;"&gt;Chrome</th&gt;
<th style="background: #333; color: #fff; padding: 4px;"&gt;Firefox</th&gt;
<th style="background: #333; color: #fff; padding: 4px;"&gt;IE</th&gt;
<th style="background: #333; color: #fff; padding: 4px;"&gt;Opera</th&gt;
<th style="background: #333; color: #fff; padding: 4px;"&gt;Safari</th&gt;
</tr&gt;
<tr&gt;
<td style="padding: 4px 4px; border: 1px solid #777;"&gt;<a href="http://stevesouders.com/tests/spof/slow-script.php"&gt;External Script</a&gt;</td&gt;
<td style="padding: 4px 4px; border: 1px solid #777; text-align: center; background: #F7D6D6;"&gt;blank below</td&gt;
<td style="padding: 4px 4px; border: 1px solid #777; text-align: center; background: #F7D6D6;"&gt;blank below</td&gt;
<td style="padding: 4px 4px; border: 1px solid #777; text-align: center; background: #F7D6D6;"&gt;blank below</td&gt;
<td style="padding: 4px 4px; border: 1px solid #777; text-align: center; background: #F7D6D6;"&gt;blank below</td&gt;
<td style="padding: 4px 4px; border: 1px solid #777; text-align: center; background: #F7D6D6;"&gt;blank below</td&gt;
</tr&gt;
<tr&gt;
<td style="padding: 4px 4px; border: 1px solid #777;"&gt;<a href="http://stevesouders.com/tests/spof/slow-stylesheet.php"&gt;Stylesheet</a&gt;</td&gt;
<td style="padding: 4px 4px; border: 1px solid #777; text-align: center; background: #DFFCD8;"&gt;flash</td&gt;
<td style="padding: 4px 4px; border: 1px solid #777; text-align: center; background: #DFFCD8;"&gt;flash</td&gt;
<td style="padding: 4px 4px; border: 1px solid #777; text-align: center; background: #F7D6D6;"&gt;blank below</td&gt;
<td style="padding: 4px 4px; border: 1px solid #777; text-align: center; background: #DFFCD8;"&gt;flash</td&gt;
<td style="padding: 4px 4px; border: 1px solid #777; text-align: center; background: #F7D6D6;"&gt;blank below</td&gt;
</tr&gt;
<tr&gt;
<td style="padding: 4px 4px; border: 1px solid #777;"&gt;<a href="http://stevesouders.com/tests/spof/slow-font.php"&gt;inlined @font-face</a&gt;</td&gt;
<td style="padding: 4px 4px; border: 1px solid #777; text-align: center; background: #FFFFD6;"&gt;delayed</td&gt;
<td style="padding: 4px 4px; border: 1px solid #777; text-align: center; background: #DFFCD8;"&gt;flash</td&gt;
<td style="padding: 4px 4px; border: 1px solid #777; text-align: center; background: #DFFCD8;"&gt;flash</td&gt;
<td style="padding: 4px 4px; border: 1px solid #777; text-align: center; background: #DFFCD8;"&gt;flash</td&gt;
<td style="padding: 4px 4px; border: 1px solid #777; text-align: center; background: #FFFFD6;"&gt;delayed</td&gt;
</tr&gt;
<tr&gt;
<td style="padding: 4px 4px; border: 1px solid #777;"&gt;<a href="http://stevesouders.com/tests/spof/slow-font-stylesheet.php"&gt;Stylesheet with @font-face</a&gt;</td&gt;
<td style="padding: 4px 4px; border: 1px solid #777; text-align: center; background: #FFFFD6;"&gt;delayed</td&gt;
<td style="padding: 4px 4px; border: 1px solid #777; text-align: center; background: #DFFCD8;"&gt;flash</td&gt;
<td style="padding: 4px 4px; border: 1px solid #777; text-align: center; background: #F7D6D6;"&gt;totally blank*</td&gt;
<td style="padding: 4px 4px; border: 1px solid #777; text-align: center; background: #DFFCD8;"&gt;flash</td&gt;
<td style="padding: 4px 4px; border: 1px solid #777; text-align: center; background: #FFFFD6;"&gt;delayed</td&gt;
</tr&gt;
<tr&gt;
<td style="padding: 4px 4px; border: 1px solid #777;"&gt;<a href="http://stevesouders.com/tests/spof/slow-font-script.php"&gt;Script then @font-face</a&gt;</td&gt;
<td style="padding: 4px 4px; border: 1px solid #777; text-align: center; background: #FFFFD6;"&gt;delayed</td&gt;
<td style="padding: 4px 4px; border: 1px solid #777; text-align: center; background: #DFFCD8;"&gt;flash</td&gt;
<td style="padding: 4px 4px; border: 1px solid #777; text-align: center; background: #F7D6D6;"&gt;totally blank*</td&gt;
<td style="padding: 4px 4px; border: 1px solid #777; text-align: center; background: #DFFCD8;"&gt;flash</td&gt;
<td style="padding: 4px 4px; border: 1px solid #777; text-align: center; background: #FFFFD6;"&gt;delayed</td&gt;
</tr&gt;
</tbody&gt;
</table&gt;
<p&gt;* Internet Explorer 9 does not display a blank page, but does &#8220;flash&#8221; the element.</p&gt;
<p&gt;The failure cases are highlighted in red. Here are the four possible outcomes sorted from worst to best:</p&gt;
<ul&gt;
<li&gt;<em&gt;totally blank</em&gt; &#8211; Nothing in the page is rendered &#8211; the entire page is blank.</li&gt;
<li&gt;<em&gt;blank below</em&gt; &#8211; All the DOM elements below the resource in question are not rendered.</li&gt;
<li&gt;<em&gt;delayed</em&gt; &#8211; Text that uses the @font-face style is invisible until the font file arrives.</li&gt;
<li&gt;<em&gt;flash</em&gt; &#8211; DOM elements are rendered immediately, and then redrawn if necessary after the stylesheet or font has finished downloading.</li&gt;
</ul&gt;
<h2&gt;Web Performance avoids SPOF</h2&gt;
<p&gt;It turns out that there are web performance best practices that, in addition to making your pages faster, also avoid most of these frontend single points of failure. Let&#8217;s look at the tests one by one.</p&gt;
<dl&gt;
<dt&gt;<strong&gt;<a href="http://stevesouders.com/tests/spof/slow-script.php"&gt;External Script</a&gt;</strong&gt; </dt&gt;
<dd style="margin-bottom: 10px;"&gt;All browsers block rendering of elements below an external script until the script arrives and is parsed and executed. Since many sites put scripts in the HEAD, this means the entire page is typically blank. That&#8217;s why I believe the most important web performance coding pattern for today&#8217;s web sites is to <a href="http://www.stevesouders.com/blog/2009/04/27/loading-scripts-without-blocking/"&gt;load JavaScript asynchronously</a&gt;. Not only does this improve performance, but it avoids making external scripts a possible SPOF. </dd&gt;
<dt&gt;<strong&gt;<a href="http://stevesouders.com/tests/spof/slow-stylesheet.php"&gt;Stylesheet</a&gt;</strong&gt; </dt&gt;
<dd style="margin-bottom: 10px;"&gt;Browsers are split on how they handle stylesheets. Firefox and Opera charge ahead and render the page, and then flash the user if elements have to be redrawn because their styling changed. Chrome, Internet Explorer, and Safari delay rendering the page until the stylesheets have arrived. (Generally they only delay rendering elements below the stylesheet, but in <a href="http://stevesouders.com/hpws/css-bottom.php"&gt;some cases</a&gt; IE will delay rendering everything in the page.) If rendering is blocked and the stylesheet takes a long time to download, or times out, the user is left staring at a blank page. There&#8217;s not a lot of advice on loading stylesheets without blocking page rendering, primarily because it would introduce the <a href="http://www.bluerobot.com/web/css/fouc.asp/"&gt;flash of unstyled content</a&gt;.</dd&gt;
<dt&gt;<strong&gt;<a href="http://stevesouders.com/tests/spof/slow-font.php"&gt;inlined @font-face</a&gt;</strong&gt; </dt&gt;
<dd style="margin-bottom: 10px;"&gt;I&#8217;ve blogged before about the <a href="http://www.stevesouders.com/blog/2009/10/13/font-face-and-performance/"&gt;performance implications of using @font-face</a&gt;. When the @font-face style is declared in a STYLE block in the HTML document, the SPOF issues are dramatically reduced. Firefox, Internet Explorer, and Opera avoid making these custom font files a SPOF by rendering the affected text and then redrawing it after the font file arrives. Chrome and Safari don&#8217;t render the customized text at all until the font file arrives. I&#8217;ve drawn these cells in yellow since it could cause the page to be unusable for users using these browsers, but most sites only use custom fonts on a subset of the page.</dd&gt;
<dt&gt;<strong&gt;<a href="http://stevesouders.com/tests/spof/slow-font-stylesheet.php"&gt;Stylesheet with @font-face</a&gt;</strong&gt; </dt&gt;
<dd style="margin-bottom: 10px;"&gt;Inlining your @font-face style is the key to avoiding having font files be a single point of failure. If you inline your @font-face styles and the font file takes forever to return or times out, the worst case is the affected text is invisible in Chrome and Safari. But at least the rest of the page is visible, and everything is visible in Firefox, IE, and Opera. Moving the @font-face style to a stylesheet not only slows down your site (by requiring two sequential downloads to render text), but it also creates a special case in Internet Explorer 7 &amp; 8 where the entire page is blocked from rendering. IE 6 is only slightly better &#8211; the elements below the stylesheet are blocked from rendering (but if your stylesheet is in the HEAD this is the same outcome).</dd&gt;
<dt&gt;<strong&gt;<a href="http://stevesouders.com/tests/spof/slow-font-script.php"&gt;Script then @font-face</a&gt;</strong&gt; </dt&gt;
<dd&gt;Inlining your @font-face style isn&#8217;t enough to avoid the entire page SPOF that occurs in IE. You also have to make sure the inline STYLE block isn&#8217;t preceded by a SCRIPT tag. Otherwise, your entire page is blank in IE waiting for the font file to arrive. If that file is slow to return, your users are left staring at a blank page.</dd&gt;
</dl&gt;
<h2&gt;SPOF is bad</h2&gt;
<p&gt;Five years ago most of the attention on web performance was focused on the backend. Since then we&#8217;ve learned that 80% of the time users wait for a web page to load is the responsibility of the frontend. I feel this same bias when it comes to identifying and guarding against single points of failure that can bring down a web site &#8211; the focus is on the backend and there&#8217;s not enough focus on the frontend. For larger web sites, the days of a single server, single router, single data center, and other backend SPOFs are way behind us. And yet, most major web sites include scripts and stylesheets in the typical way that creates a frontend SPOF. Even more worrisome &#8211; many of these scripts are from third parties for social widgets, web analytics, and ads.</p&gt;
<p&gt;Look at the scripts, stylesheets, and font files in your web page from a worst case scenario perspective. Ask yourself:</p&gt;
<ul&gt;
<li&gt;Is your web site&#8217;s availability dependent on these resources?</li&gt;
<li&gt;Is it possible that if one of these resources timed out, users would be blocked from seeing your site?</li&gt;
<li&gt;Are any of these single point of failure resources from a third party?</li&gt;
<li&gt;Would you rather embed resources in a way that avoids making them a frontend SPOF?</li&gt;
</ul&gt;
<p&gt;Make sure you&#8217;re aware of your frontend SPOFs, track their availability and latency closely, and embed them in your page in a non-blocking way whenever possible.</p&gt;
<div style="background: #D6EBEA; padding: 2px 8px 2px 8px; margin-top: 1em; margin-bottom: 1em;"&gt;<strong&gt;Update Oct 12:</strong&gt; Pat Meenan created a <a href="http://blog.patrickmeenan.com/2011/10/testing-for-frontend-spof.html"&gt;blackhole server</a&gt; that you can use to detect frontend SPOF in webpages.</div&gt;

<div class="wp_rp_wrap  wp_rp_momma" id="wp_rp_first"&gt;<div class="wp_rp_content"&gt;<h3 class="related_post_title"&gt;Related Posts</h3&gt;<ul class="related_post wp_rp" style="visibility: visible"&gt;<li &gt;<a href="http://www.stevesouders.com/blog/2009/10/13/font-face-and-performance/" class="wp_rp_title"&gt;@font-face and performance</a&gt;</li&gt;<li &gt;<a href="http://www.stevesouders.com/blog/2009/02/09/john-resig-drop-in-javascript-performance/" class="wp_rp_title"&gt;John Resig: Drop-in JavaScript Performance</a&gt;</li&gt;<li &gt;<a href="http://www.stevesouders.com/blog/2010/02/12/5e-speculative-background-images/" class="wp_rp_title"&gt;5e speculative background images</a&gt;</li&gt;<li &gt;<a href="http://www.stevesouders.com/blog/2008/12/17/state-of-performance-2008/" class="wp_rp_title"&gt;State of Performance 2008</a&gt;</li&gt;<li &gt;<a href="http://www.stevesouders.com/blog/2010/02/15/browser-performance-wishlist/" class="wp_rp_title"&gt;Browser Performance Wishlist</a&gt;</li&gt;</ul&gt;<div class="wp_rp_footer"&gt;<a class="wp_rp_backlink" target="_blank" rel="nofollow" href="http://www.zemanta.com/?wp-related-posts"&gt;Zemanta</a&gt;</div&gt;</div&gt;</div&gt;
            
            			
		</div&gt;<!-- #post-## --&gt;


		
			<div id="comments"&gt;

			<h3 id="comments-title"&gt;9 Responses to <em&gt;Frontend SPOF</em&gt;</h3&gt;


			<ol class="commentlist"&gt;
				<li class="comment even thread-even depth-1" id="li-comment-2125"&gt;
<div id="comment-2125"&gt;
<p class="comment-metadata"&gt;
<strong&gt;<a href='http://jpv.typepad.com' rel='external nofollow' class='url'&gt;jpvincent</a&gt;</strong&gt; | 02-Jun-10 at 4:07 am | <a href="http://www.stevesouders.com/blog/2010/06/01/frontend-spof/#comment-2125"&gt;Permalink</a&gt; |  </p&gt;


<p&gt;about putting scripts at the bottom, i found a way I didnt saw elsewhere for those who dont want to rewrite portion of JS code like Facebook or Google Analytics did : </p&gt;
<p&gt;- save the onerror then mute the JS errors on the page<br /&gt;
- display page, including inline JS calls<br /&gt;
- put back the default JS error handler<br /&gt;
- include the JS<br /&gt;
- list the  of the page, eval them</p&gt;
<p&gt;more code and graphics here (post in french, sorry)<br /&gt;
<a href="http://jpv.typepad.com/blog/2010/05/performances-web-put-scripts-at-the-bottom-oui-mais-comment-.html" rel="nofollow"&gt;http://jpv.typepad.com/blog/2010/05/performances-web-put-scripts-at-the-bottom-oui-mais-comment-.html</a&gt;</p&gt;
</div&gt;
</li&gt;<!-- #comment-## --&gt;
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-2126"&gt;
<div id="comment-2126"&gt;
<p class="comment-metadata"&gt;
<strong&gt;<a href='http://jpv.typepad.com' rel='external nofollow' class='url'&gt;jpvincent</a&gt;</strong&gt; | 02-Jun-10 at 4:08 am | <a href="http://www.stevesouders.com/blog/2010/06/01/frontend-spof/#comment-2126"&gt;Permalink</a&gt; |  </p&gt;


<p&gt;last step is<br /&gt;
- list the &lt;script&gt; of the page, eval() them</p&gt;
</div&gt;
</li&gt;<!-- #comment-## --&gt;
<li class="comment even thread-even depth-1" id="li-comment-2127"&gt;
<div id="comment-2127"&gt;
<p class="comment-metadata"&gt;
<strong&gt;Balázs Galambosi</strong&gt; | 02-Jun-10 at 7:55 am | <a href="http://www.stevesouders.com/blog/2010/06/01/frontend-spof/#comment-2127"&gt;Permalink</a&gt; |  </p&gt;


<p&gt;There is nothing deferred about Google Analytics&#8217; async snippet, it is only loaded in a non-blocking way.</p&gt;
<p&gt;In fact it is supposed to be put in the [1] whereas we were told to place the old one right before the  tag.[2]</p&gt;
<p&gt;So it is less deferred now, than it was before. The reason it has changed is that now you can place it in the head without worrying about other elements to be delayed as a consequence. Also, you get more accurate statistics because there are less things that may delay or block your tracking (as this article points out).</p&gt;
<p&gt;Anyway, shutting down error handling is not one of those so-called &#8220;best practices&#8221;.</p&gt;
<p&gt;If you want to solve it more elegantly you may want to check out Peter Michaux article about after-DOM-load execution. [3]</p&gt;
<p&gt;For basic things, Facebook&#8217;s way is enough. But what they do is they use a global event handler for all the events on the page, so there is no need to attach them inline or after the onload. Thus, the functionality of elements are handled in one place instead of tons of small event handlers. It scales nicely if you ask me. :) [4]</p&gt;
<p&gt;There are also some nice techniques about deferred execution on this blog. [5]</p&gt;
<p&gt;Finally, tweaking is always the worst thing to do, rewriting or refactoring code can be costly in a short term, but with some hours of work now you can save weeks of confusion later. Especially if you are working in a team.</p&gt;
<p&gt;[1] <a href="http://code.google.com/apis/analytics/docs/tracking/asyncTracking.html" rel="nofollow"&gt;http://code.google.com/apis/analytics/docs/tracking/asyncTracking.html</a&gt;</p&gt;
<p&gt;[2] <a href="http://code.google.com/apis/analytics/docs/tracking/gaTrackingOverview.html" rel="nofollow"&gt;http://code.google.com/apis/analytics/docs/tracking/gaTrackingOverview.html</a&gt;</p&gt;
<p&gt;[3] <a href="http://peter.michaux.ca/articles/the-window-onload-problem-really-solved" rel="nofollow"&gt;http://peter.michaux.ca/articles/the-window-onload-problem-really-solved</a&gt;</p&gt;
<p&gt;[4] <a href="http://www.slideshare.net/makinde/javascript-primer" rel="nofollow"&gt;http://www.slideshare.net/makinde/javascript-primer</a&gt;</p&gt;
<p&gt;[5] <a href="http://www.stevesouders.com/blog/2009/12/07/downloading-javascript-as-strings/" rel="nofollow"&gt;http://www.stevesouders.com/blog/2009/12/07/downloading-javascript-as-strings/</a&gt;</p&gt;
</div&gt;
</li&gt;<!-- #comment-## --&gt;
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-2128"&gt;
<div id="comment-2128"&gt;
<p class="comment-metadata"&gt;
<strong&gt;Balázs Galambosi</strong&gt; | 02-Jun-10 at 7:58 am | <a href="http://www.stevesouders.com/blog/2010/06/01/frontend-spof/#comment-2128"&gt;Permalink</a&gt; |  </p&gt;


<p&gt;stripping tags, bites :) wordpress hasn&#8217;t got htmlspecialchars() or somethin&#8217;? &#8230;</p&gt;
<p&gt;Anyaways, errata: &#8220;In fact it is supposed to be put in the {head}[1] whereas we were told to place the old one right before the tag {/body}.[2]&#8220;</p&gt;
</div&gt;
</li&gt;<!-- #comment-## --&gt;
<li class="comment even thread-even depth-1" id="li-comment-2130"&gt;
<div id="comment-2130"&gt;
<p class="comment-metadata"&gt;
<strong&gt;<a href='http://jpv.typepad.com' rel='external nofollow' class='url'&gt;jpvincent</a&gt;</strong&gt; | 03-Jun-10 at 2:56 am | <a href="http://www.stevesouders.com/blog/2010/06/01/frontend-spof/#comment-2130"&gt;Permalink</a&gt; |  </p&gt;


<p&gt;when I say &#8220;inline JS&#8221;, I&#8217;m not talking about stuff like Peter Michaux is using &lt;input onfocus=&#8221;&#8230;&#8221;&gt; but rather<br /&gt;
&lt;script&gt;<br /&gt;
MY.enrichForm(&#8216;myid&#8217;);<br /&gt;
&lt;/script&gt;</p&gt;
<p&gt;and the problem I tried to solve was having put JS dependancies at the bottom of the page but JS functions still called inline. Ideally, I would have made a big page manager waiting for the body.onload before running the functions, but that&#8217;s not the way my site&#8217;s framework works</p&gt;
<p&gt;for the new async ga.js the calling of the methods (say _trackPageview and _setAccount) are defered, until the full file is there. Yes it&#8217;s loaded in a non-obstrusive way, but the innovation of GA was that you can call all of the GA methods without the JS dependancy being actually here.</p&gt;
<p&gt;FB solves the problem of calling a JS action that is defined in a file that is still not arrived by having a generic listener, that will extract info from the markup to know what to do and get via XHR the JS+HTML (if needed) generated on the server-side.</p&gt;
<p&gt;both solutions were requiring more changes than I wanted to, and the one I finally found is perfectly maintainable</p&gt;
<p&gt;In my technique, the muting of the JS errors just lasts the time of loading the HTML, to prevent inline JS call to warn the user, then I re-enable the default one. The functionality of the error handling is preserved.</p&gt;
</div&gt;
</li&gt;<!-- #comment-## --&gt;
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-2131"&gt;
<div id="comment-2131"&gt;
<p class="comment-metadata"&gt;
<strong&gt;Balázs Galambosi</strong&gt; | 03-Jun-10 at 5:45 pm | <a href="http://www.stevesouders.com/blog/2010/06/01/frontend-spof/#comment-2131"&gt;Permalink</a&gt; |  </p&gt;


<p&gt;Inline scripts are a bad practice. Again, the idea is to separate the markup(HTML) from the presentation(CSS) and extra functionality(JS).</p&gt;
<p&gt;Moreover: &#8220;<b&gt;Inline scripts block rendering</b&gt;, just like external scripts, but are worse. External scripts only block the rendering of elements below them in the page. Inline scripts block the rendering of everything in the page.&#8221; [1]</p&gt;
<p&gt;I also think that browsers don&#8217;t appreciate bunch of meaningless code inside the page, for you may not catch errors, but they will still try to parse and execute it over and over again.</p&gt;
<p&gt;You can put your inline scripts into js files, that are included at the end of the page by some server side logic depending on the request url.</p&gt;
<p&gt;Or it is not that hard to write code that deals with HTML elements by checking if they are actually there. So you can make the whole thing external and enjoy the advantages of caching.</p&gt;
<p&gt;Also, during loading of the HTML lot of things can happen. Event listeners can go mad, users can cause problems that you may not be prepared for. Silencing error handler is a very very bad practice.</p&gt;
<p&gt;No offense, using this technique is one thing, but encouraging others to use it as well is just plain awful.</p&gt;
<p&gt;The best tweaking is no tweaking.</p&gt;
<p&gt;[1] <a href="http://www.stevesouders.com/blog/2009/05/06/positioning-inline-scripts/" rel="nofollow"&gt;http://www.stevesouders.com/blog/2009/05/06/positioning-inline-scripts/</a&gt;</p&gt;
</div&gt;
</li&gt;<!-- #comment-## --&gt;
<li class="comment even thread-even depth-1" id="li-comment-4031"&gt;
<div id="comment-4031"&gt;
<p class="comment-metadata"&gt;
<strong&gt;Michael</strong&gt; | 02-Aug-12 at 10:19 pm | <a href="http://www.stevesouders.com/blog/2010/06/01/frontend-spof/#comment-4031"&gt;Permalink</a&gt; |  </p&gt;


<p&gt;Thanks for the great article.</p&gt;
<p&gt;However, it&#8217;s still unclear to me, if Front End SPOF is better solved by: a) async loading third party scripts, or b) putting all s at the bottom of the .  </p&gt;
<p&gt;What&#8217;s the diff when speaking about SPOF?</p&gt;
<p&gt;Thanks again!</p&gt;
</div&gt;
</li&gt;<!-- #comment-## --&gt;
<li class="comment byuser comment-author-sowrock bypostauthor odd alt thread-odd thread-alt depth-1 author" id="li-comment-4032"&gt;
<div id="comment-4032"&gt;
<p class="comment-metadata"&gt;
<strong&gt;<a href='http://stevesouders.com' rel='external nofollow' class='url'&gt;Steve Souders</a&gt;</strong&gt; | 03-Aug-12 at 9:08 am | <a href="http://www.stevesouders.com/blog/2010/06/01/frontend-spof/#comment-4032"&gt;Permalink</a&gt; |  </p&gt;


<p&gt;@Michael: Async is better because it&#8217;ll render the snippets sooner but won&#8217;t block the main content of the page. Also, depending on the browser, it will allow the onload event to fire.</p&gt;
</div&gt;
</li&gt;<!-- #comment-## --&gt;
<li class="comment even thread-even depth-1" id="li-comment-23279"&gt;
<div id="comment-23279"&gt;
<p class="comment-metadata"&gt;
<strong&gt;Nick Salyzyn</strong&gt; | 14-Feb-13 at 1:49 pm | <a href="http://www.stevesouders.com/blog/2010/06/01/frontend-spof/#comment-23279"&gt;Permalink</a&gt; |  </p&gt;


<p&gt;This would be a good spot to discuss base64 encoded fonts placed directly in the css file.  In the same way you might use background-image: url(data:image/png;base64,&#8230;);</p&gt;
</div&gt;
</li&gt;<!-- #comment-## --&gt;
			</ol&gt;







</div&gt;<!-- #comments --&gt;


</div&gt; <!-- end div id="content" --&gt;
</div&gt;
<div id="footer" class="containerwrapperpadded"&gt;
<p&gt;&copy; Steve Souders</p&gt;
</div&gt;
</body&gt;
</html&gt;

<!-- Performance optimized by W3 Total Cache. Learn more: http://www.w3-edge.com/wordpress-plugins/

Page Caching using disk: enhanced
Database Caching 16/32 queries in 0.352 seconds using disk

 Served from: www.stevesouders.com @ 2013-09-30 03:15:27 by W3 Total Cache --&gt;
        </textarea>
        </div>
        <script src="http://libs.baidu.com/jquery/2.0.0/jquery.min.js"></script>
        <script src="../js/clearly.js"></script>
        <script>
            var html = window.__getMyClearlyResults().html;
            $('#main_content_wrap').html(html);
        </script>
  </body>
</html>
