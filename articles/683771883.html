<!doctype html>
<html>
<head>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Applying Alpha Channels to JPGs</title>
<link rel="stylesheet" href="../css/article.css" />
</head>
<body>
<div class="m-content">
<h1>Applying Alpha Channels to JPGs</h1>
<article class="post-1194 post type-post status-publish format-standard hentry category-coding category-html5-coding category-svg category-tutorial tag-alpha-channel tag-coding tag-compression tag-frontend-development tag-html5 tag-image-manipulation tag-image-optimization tag-jpg tag-performance tag-svg tag-transparent-png" id="post-1194"> <section class="article-meta-section"> <time class="post-date">08-01-2014 </time> </section><p>In this article I will show how to combine the advantages of JPG's high compression rate with the flexibility of having alpha channels like we use them in PNG. Open the demo to see this technique in action, a semi transparent JPG in front of HTML text:</p> <a class="openexample ebox" href="http://w3.eleqtriq.com/wp-content/static/demos/2014/jpgtransparency/jpg-alpha.html" data-width="600" data-height="500" title="Example of JPG with an alpha channel">Demo of JPG with alpha channel.</a><p><a href="http://caniuse.com/#search=png" title="Browser support for png with alpha channels on caniuse.com">As all modern browsers</a> support images with alpha channels<sup><a href="http://w3.eleqtriq.com/2014/08/applying-alpha-channels-to-jpgs/?utm_source=html5weekly&amp;utm_medium=email#fn1" id="ref1">1</a></sup> it has become fairly easy for designers to place semi transparent images in front of irregular backgrounds.</p><p>The weapon of choice will be <a href="http://www.w3.org/TR/PNG/" alt="The PNG image format">PNG</a> as it is the only widespread image format that supports alpha channels (<a href="https://developers.google.com/speed/webp/gallery2" title="Alpha transpareny in WEBP">WEBP is a promising alternative</a>, but <a href="http://caniuse.com/#search=webp" title="WEBP support in browsers on caniuse.com">currently only supported in Chrome and Android</a>)[<strong>Update</strong> As Mathias Bynens correctly pointed out in the comments: Opera supports WebP too].</p><p>But PNG has its drawbacks. It comes in 2 flavours: a lossless compressed image with 24bit true colors. Images in this format look superb, but can quickly grow HUGE.</p><p><a class="openexample ebox" href="http://w3.eleqtriq.com/wp-content/static/demos/2014/jpgtransparency/png-24bit-alpha.html" data-width="340" data-height="340" title="32bit PNG">32bit PNG.</a></p><p>And then there's the 8bit (256 color) PNG with alpha channel. When exported cleverly with the right color palette and the right amount of dithering it can be rather small, but most of the time a loss in image quality because of the limited color palette is unavoidable. Look closely at the color gradients in this example:</p><a class="openexample ebox" href="http://w3.eleqtriq.com/wp-content/static/demos/2014/jpgtransparency/png-8bit-alpha.html" data-width="340" data-height="340" title="8bit PNG">8bit PNG.</a><p>Wouldn't it be great if we could get the high compression and rich color depth of the JPG image format together with alpha channels? Actually, with the help of SVG, this is a breeze.</p> <a class="openexample ebox" href="http://w3.eleqtriq.com/wp-content/static/demos/2014/jpgtransparency/jpg-alpha.html" data-width="600" data-height="500" title="Example of JPG with an alpha channel">Open demo of JPG with alpha channel.</a><p>This demo contains a JPEG that is wrapped into an SVG. The alpha channel then is created via the SVG "mask" element. The <a href="http://w3.eleqtriq.com/wp-content/static/demos/2014/jpgtransparency/img/corona.svg" title="See JPEG wrapped into SVG">SVG and the JPG</a> (compressed at 50%) combined weigh in at 26kb. The same motive exported into a <a href="http://w3.eleqtriq.com/wp-content/static/demos/2014/jpgtransparency/img/corona-alpha-8.png" title="See 8bit PNG image">8bit PNG</a> will be 32kb. Exported into a <a href="http://w3.eleqtriq.com/wp-content/static/demos/2014/jpgtransparency/img/corona-alpha-32.png" title="See 32bit PNG image">32bit PNG</a> it will be whopping 120kb.</p><h3>Creating the SVG wrapped alpha JPG:</h3><h4>1. Preparing the JPG</h4><p>Here's how to prepare the JPG:</p><h4>2. Creating the SVG:</h4><p>Fire up your editor and create a new SVG. We will put the JPG into a symbol element, so we need only 1 reference to the JPG that we then can use across our document:</p> <code> <span>&lt;symbol  id="img_corona"&gt;</span> <span class="indent-2">&lt;image width="840" height="400" xlink:href="corona.jpg" /&gt;</span> <span>&lt;/symbol&gt;</span> </code><p>We define a mask. As we only want to have the "alpha part" of our image placed exactly above the "image part",the JPG must be positioned 50% to the left:</p> <code> <span>&lt;mask id="mask_corona"&gt;</span> <span class="indent-2">&lt;use xlink:href="#img_corona" width="840" height="400" x="-420" y="0" style="overflow:hidden;"/&gt;</span> <span>&lt;/mask&gt;</span> </code><p>Almost there. Let's put a reference to the symbol containing the image inline. And now we will cut off the right part of the image that contains the "alpha-channel":</p> <code> <span>&lt;use id="corona" xlink:href="#img_corona" width="430" height="400" style="overflow:hidden;"/&gt;</span> </code><p>Last thing to do: apply our "alpha channel" to the image with CSS. Here's the code in one piece: <code> <span>&lt;svg version="1.1"; preserveAspectRatio="none"; xmlns="http://www.w3.org/2000/svg"; xmlns:xlink="http://www.w3.org/1999/xlink"&gt;</span> <span class="indent-2">&lt;style type="text/css"&gt;</span> <span class="indent-3">&lt;![CDATA[</span> <span class="indent-4">#corona{</span> <span class="indent-5">mask :url(#mask_corona);</span> <span class="indent-4">}</span> <span class="indent-3">]]&gt;</span> <span class="indent-2">&lt;/style&gt;</span> <span></span> <span class="indent-2">&lt;symbol  id="img_corona"&gt;</span> <span class="indent-3">&lt;image width="840" height="400" xlink:href="corona.jpg" /&gt;</span> <span class="indent-2">&lt;/symbol&gt;</span> <span></span> <span class="indent-2">&lt;mask id="mask_corona"&gt;</span> <span class="indent-3">&lt;use xlink:href="#img_corona" width="840" height="400" x="-420" y="0" style="overflow:hidden;"/&gt;</span> <span class="indent-2">&lt;/mask&gt;</span> <span></span> <span class="indent-2">&lt;use id="corona" xlink:href="#img_corona" width="420" height="400" style="overflow:hidden;"/&gt;</span> <span>&lt;/svg&gt;</span> </code></p><p>I hope I showed that this is can be an elegant method to get highly compressed images with alpha channels. This method can be used in every browser that supports SVG which means <a href="http://caniuse.com/#search=svg" title="Browser support for SVG on caniuse.com">browser support is pretty good</a>.</p><p>If you want to check out this example you can play with <a href="http://codepen.io/DirkWeber/pen/DtJvf" title="Alpha JPG on codepen">this pen</a> or check out my <a href="https://github.com/dirkweber/svgdemos" title="SVG repo on github">github repo with my SVG experiments</a>.</p>  <section class="notes"><a href="http://w3.eleqtriq.com/2014/08/applying-alpha-channels-to-jpgs/trackback/" class="trackback" rel="trackback">Trackback</a></section></article></div>
<script>var _gaq = _gaq || []; _gaq.push(['_setAccount', 'UA-34802167-1']); _gaq.push(['_setDomainName', 'liuzhe.co']); _gaq.push(['_trackPageview']); (function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true; ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'; var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s); })();</script></body>
</html>