<!doctype html>
<html>
<head>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>15 things you can (and should) do to make your site faster for mobile users</title>
<link rel="stylesheet" href="../css/article.css" />
</head>
<body>
<div class="m-content">
<h1>15 things you can (and should) do to make your site faster for mobile users</h1>
<div class="text"><p>I thought this seemed like a timely post given Keynote’s new report showing that <strong><a title="Internet Retailer: Mobile consumers expect speed greater than many retailers are providing" href="http://www.internetretailer.com/2012/08/07/mobile-consumers-expect-greater-speed" target="_blank">64% of smartphone users expect sites to load in 4 seconds or less</a></strong>. This finding isn’t a total surprise. Previous studies have shown that <strong><a title="Strangeloop: Mobile device users expect sites to load fast [INFOGRAPHICS]" href="http://www.strangeloopnetworks.com/resources/infographics/web-performance-and-user-expectations/mobile-device-users-expect-sites-to-load-fast/" target="_blank">people expect sites to load at least as fast on their mobile devices as they do on their desktops</a></strong>. But it’s still a wake-up call for any site owner who may have lapsed into a bit of complacency. (And given the fact that it’s August, we’re probably all a little guilty of lapsing into late-summer complacency.)</p><p>As you may already know, <strong>about 80% of the time it takes to display a typical web page is shared between performing client-side processing and loading resources like stylesheets, script files, and images</strong>. So the three main strategies for improving performance — for both mobile and desktop visitors — are to:</p><ol><li>Reduce the number of HTTP requests required to fetch the resources for each page.</li><li>Reduce the size of the payload needed to fulfill each request.</li><li>Optimize client-side processing priorities and script execution efficiency.</li></ol><p>As you probably also know, <strong>mobile users face unique performance challenges</strong> when it comes to implementing the strategies above. These challenges include:</p><ul><li><strong>Slower networks</strong> (which is why reducing requests and payload is important)</li><li><strong>Mobile browsers are slower to parse HTML and slower to execute JavaScript</strong> (so optimizing client-side processing is crucial)</li><li><strong>Mobile browser caches are much smaller than those of desktop browsers</strong> (requiring new approaches to leveraging local storage of reusable resources)</li></ul><p>There are a number of fundamental and advanced tactics that you can use to take on these challenges and win. I’m going to give an overview of each one here, but to get more insight and specific how-to details, I urge you to download Strangeloop’s <a title="Strangeloop: Mobile Website Optimization [WHITEPAPER]" href="http://www.strangeloopnetworks.com/resources/whitepapers/mobile-website-optimization-19-things-you-can-do-to-make-your-site-faster-for-mobile-users/" target="_blank"><strong>whitepaper on mobile website optimization</strong></a>.</p><h2>REDUCE REQUESTS</h2><h3>1. Consolidate resources</h3><p>By now, this is a standard practice, so I’m not going to explain it here, but I want to point out that <strong>resource consolidation can be a double-edged sword for mobile browsers</strong>. Reducing requests speeds up page load the first time, but larger consolidated resources may not be cached efficiently. So if you’re using this technique, make sure to balance it with techniques to optimize local storage (coming up next).</p><h3>2. Use browser caching and localStorage</h3><p>Caching is an essential technique for achieving acceptable performance, but desktop and mobile caches are not created equal. Mobile browser caches are usually much smaller than on desktop machines, causing items to be flushed quickly, so traditional browser caching doesn’t work well for mobile devices. Luckily, the <strong><a title="HTML5 Web Storage specification" href="http://www.w3.org/TR/webstorage/" target="_blank">HTML5 Web Storage specification</a></strong>, which has been implemented in all major desktop and mobile browsers, provides a great alternative to relying solely on browser caching.</p><h3>3. Embed resources in HTML for first-time use</h3><p>If a resource doesn’t have a high likelihood of already being cached (such as in a mobile context), it is often best to embed that resource in the page’s HTML — a technique called “inlining” — rather than storing it externally and linking to it.</p><p><strong>The disadvantage of inlining is that page size can become very large, so it’s crucial for a web application that uses this strategy to be able to track when the resource is needed and when it is already cached on the client.</strong> In addition, the application must generate code to store the resource on the client after sending it inline the first time. For this reason, using HTML5 localStorage on mobile devices (as described above) is a great companion to inlining.</p><h3>4. Use HTML5 server-sent events</h3><p>The HTML5 EventSource object and Server-Sent events enable JavaScript code in the browser to open a much more efficient channel from the server to the browser, which the server can then use to send data as it becomes available, eliminating the HTTP overhead of creating multiple polling requests.</p><h3>5. Eliminate redirects</h3><p>When users try to navigate to a standard desktop site from a mobile device, this often generates an extra round trip to the client and back to the mobile site, consuming several hundred milliseconds over mobile networks. For obvious reasons, <strong>it’s faster to deliver the mobile web page directly in response to the original request, rather than delivering a redirect message that then requests the mobile page</strong>. And as a courtesy to users who prefer to view the desktop site on their mobile device, you can provide a link on the mobile site that signals your application to suppress this behavior.</p><h2>REDUCE PAYLOADS</h2><h3>6. Compression and minification</h3><p>Compression and minification are core best practices. Compression technologies such as gzip reduce payloads; <strong>text-based responses, including HTML, XML, JSON, JavaScript, and CSS, can all be reduced in size by as much as 70%</strong>. Minification, which is usually applied only to scripts and stylesheets, eliminates inessential characters such as spaces, newline characters, and comments; minified files are reduced by about 20%, on average.</p><p><strong>Minification not only reduces bandwidth consumption and latency, but also may mean the difference between a cacheable object and one that is too big for the cache on a particular mobile device.</strong> Gzip compression is no help in this regard, because objects aren’t cached by the browser until after they’ve been decompressed.</p><h3>7. Resize images</h3><p><a href="http://blog.yoav.ws/2012/07/Images-Can-we-have-less" target="_blank"><strong>Images are one of the single greatest performance culprits.</strong></a> On mobile devices, high-res images are a massive waste of bandwidth, processing time, and cache space. To speed up page rendering and reduce bandwidth and memory consumption, dynamically resize images in your application, or replace images with smaller versions for mobile sites. Don’t waste bandwidth by relying on the browser to scale a high-resolution image into a smaller width and height.</p><p><strong>Another option is to load a very low resolution version of an image initially to get the page up as quickly as possible, and then replace that with a higher-resolution version on the onload or ready event</strong>, after the user has had a chance to begin interacting with the page.</p><h3>8. Simplify pages with HTML5 and CSS 3.0</h3><p><a title="Dive into HTML5: Semantics" href="http://diveintohtml5.info/semantics.html" target="_blank"><strong>The HTML5 specification includes new structural elements, such as header, nav, article, and footer</strong></a>. Using these semantic elements yields a simpler and more efficiently parsed page than using generic nested div and span tags. A simpler page is smaller and loads faster, and a simpler document object model (DOM) means faster JavaScript execution. The new tags are quickly being adopted in new browser versions, including mobile browsers. Maximiliano Firtman has created <a title="Mobile HTML5" href="http://mobilehtml5.org/" target="_blank"><strong>an excellent table that shows which HTML5 features are supported by which desktop and mobile browsers</strong></a>.</p><p>Similarly, <a title="Smashing Magazine: Powerful New CSS- and JavaScript Techniques" href="http://coding.smashingmagazine.com/2012/06/21/powerful-new-cssjavascript-techniques/" target="_blank"><strong>new CSS 3.0 features can help create lightweight pages</strong></a> by providing built-in support for things like gradients, rounded borders, shadows, animations, transitions and other graphical effects that previously required you to load images.</p><h2>OPTIMIZE CLIENT-SIDE PROCESSING</h2><h3>9. Defer rendering HTML</h3><p>On mobile devices, attempting to load and render a page with lots of HTML can be slower than loading the HTML first and then rendering it. One approach is to enclose the HTML in a comment tag and then to use JavaScript to remove the comment, load the DOM, and render the page.</p><p><strong>You can also assure that the user sees the page quicker by delaying the loading and rendering any content that is “below the fold” of the initially visible area.</strong> To eliminate the need to reflow content after the remainder of the page is loaded, replace images initially with placeholder img tags that specify the correct height and width.</p><h3>10. Defer loading and executing scripts</h3><p>Parsing JavaScript can take up to 100 milliseconds per KB of code on some mobile devices. <strong>Many script libraries (such as scripts that support interactive user behaviour, e.g. drag and drop) aren’t needed until after a page has finished rendering.</strong> Downloading and parsing these scripts can be deferred until after the onload event. The same logic applies to script execution. Defer as much as possible until after onload.</p><p>The script to defer could be your own or scripts from third parties. <strong>Poorly optimized script for ads, social media widgets, or analytics support can block a page from rendering, sometimes adding precious seconds to load times.</strong> You’ll also want to carefully evaluate the use of large script frameworks like jQuery for mobile sites, especially if you are only using a couple of objects in the framework.</p><h3>11. Use Ajax for progressive enhancement</h3><p>Asynchronous JavaScript with XML (AJAX) is a technique for using the XmlHttpRequest object to fetch data from a web server without refreshing the page where the code is running. AJAX allows a page to display updated data in a section of a page without reconstructing the entire page. <strong>This can enable your application to load a bare-bones version of a page quickly, and then to fill in more detailed content while the user is already viewing the page.</strong></p><p>AJAX responses benefit from many of the same optimization techniques recommended for standard responses: cache headers, minification, gzip compression, resource consolidation, etc.</p><h3>12. Implement smart preloading that adapts to the type of network connection</h3><p>Some techniques should be used only when combined with code to detect the type of mobile connection. For example, <strong>preloading resources in anticipation of future requests is smart, but it may not be a responsible strategy if (1) the user’s bandwidth is metered and (2) some of those resources may never be needed.</strong></p><p>On Android 2.2+, the navigator.connection.type property returns values that allow you to differentiate WiFi from 2G/3G/4G connections. On Blackberry, you can check the value of blackberry.network to get similar information. In addition, server-side detection of User-Agent header data or other information embedded in requests can alert your application to the type of connection in use.</p><h3>13. Use HTML5 Web Workers for multi-threading</h3><p>The Web Worker specification in HTML5 introduces multi-threaded concurrent execution to the world of JavaScript programming. For improving the performance of mobile sites, <strong>Web Worker code can be valuable for preloading resources that a user is likely to need to complete future actions</strong>, especially when the user’s bandwidth isn’t metered. Using multi-threaded code that employs Web Worker objects (and possibly localStorage to cache the data), operations that preload resources can execute on a separate thread without affecting UI performance.</p><h3>14. Replace click events with touch events</h3><p>On touchscreen devices, the onclick event doesn’t fire immediately when a user taps the screen. Instead, <strong>the device waits up to half a second (300 milliseconds on most devices), giving the user a chance to initiate some other gesture instead of a click</strong>. This delay can significantly impede the responsive performance that users expect. To fix this, use the touchend event instead. That event fires immediately when the user taps the screen.</p><p>You may still want to handle the onclick event to ensure that the browser changes the appearance of the button to show a clicked state, and to support browsers that don’t handle touch events. To avoid duplicate code execution when both touchend and onclick code fire, add a click event handler that calls preventDefault and stopPropagation if the click was the result of a user tap that was already handled by touchend.</p><h3>15. Support the SPDY protocol</h3><p>Some of the performance bottlenecks that afflict web sites, whether desktop or mobile, result from inefficiencies in the application-layer HTTP and HTTPS protocols. In 2009, Google began work on an alternative protocol named SPDY that addresses some of these limitations. As web servers are released that implement SPDY, your site will be able to use this protocol for any user with a browser that supports it. <strong>Google’s SPDY testing reports improvements between 27% and 60%.</strong></p><p>As I mentioned above, this is a pretty high-level overview of these mobile-boosting strategies. If you’re looking for more background, as well as how-to information, check out Strangeloop’s <a title="Strangeloop: Mobile Website Optimization [WHITEPAPER]" href="http://www.strangeloopnetworks.com/resources/whitepapers/mobile-website-optimization-19-things-you-can-do-to-make-your-site-faster-for-mobile-users/" target="_blank"><strong>mobile optimization whitepaper</strong></a>.</p><span> </span><br /><span> </span><em>Joshua Bixby is president of <a href="http://www.strangeloopnetworks.com/">Strangeloop</a>, which provides website acceleration solutions to companies like eBay/PayPal, Visa, Petco, Wine.com, and O’Reilly Media. Joshua also maintains the blog <a href="http://www.webperformancetoday.com/">Web Performance Today</a>, which explores issues and ideas about site speed, user behavior, and website optimization.</em></div></div>
<script>var _gaq = _gaq || []; _gaq.push(['_setAccount', 'UA-34802167-1']); _gaq.push(['_setDomainName', 'liuzhe.co']); _gaq.push(['_trackPageview']); (function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true; ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'; var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s); })();</script></body>
</html>